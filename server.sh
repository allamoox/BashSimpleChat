#!/bin/bash
##########################################################################################################################################################
#																			 #
#  ██████╗  █████╗ ███████╗██╗  ██╗    ███████╗██╗███╗   ███╗██████╗ ██╗     ███████╗     ██████╗██╗  ██╗ █████╗ ████████╗			         #
#  ██╔══██╗██╔══██╗██╔════╝██║  ██║    ██╔════╝██║████╗ ████║██╔══██╗██║     ██╔════╝    ██╔════╝██║  ██║██╔══██╗╚══██╔══╝		                 #
#  ██████╔╝███████║███████╗███████║    ███████╗██║██╔████╔██║██████╔╝██║     █████╗      ██║     ███████║███████║   ██║				         #
#  ██╔══██╗██╔══██║╚════██║██╔══██║    ╚════██║██║██║╚██╔╝██║██╔═══╝ ██║     ██╔══╝      ██║     ██╔══██║██╔══██║   ██║				         #
#  ██████╔╝██║  ██║███████║██║  ██║    ███████║██║██║ ╚═╝ ██║██║     ███████╗███████╗    ╚██████╗██║  ██║██║  ██║   ██║				         #
#  ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝    ╚══════╝╚═╝╚═╝     ╚═╝╚═╝     ╚══════╝╚══════╝     ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝				         #
#  ██████╗ ██╗   ██╗    ███████╗██████╗ ███████╗██████╗ ██████╗ ██╗███████╗     █████╗ ███╗   ██╗██████╗      █████╗ ███████╗███████╗███████╗███╗   ███╗ #
#  ██╔══██╗╚██╗ ██╔╝    ██╔════╝██╔══██╗██╔════╝██╔══██╗██╔══██╗██║██╔════╝    ██╔══██╗████╗  ██║██╔══██╗    ██╔══██╗██╔════╝██╔════╝██╔════╝████╗ ████║ #
#  ██████╔╝ ╚████╔╝     █████╗  ██████╔╝█████╗  ██║  ██║██║  ██║██║█████╗      ███████║██╔██╗ ██║██║  ██║    ███████║███████╗███████╗█████╗  ██╔████╔██║ #
#  ██╔══██╗  ╚██╔╝      ██╔══╝  ██╔══██╗██╔══╝  ██║  ██║██║  ██║██║██╔══╝      ██╔══██║██║╚██╗██║██║  ██║    ██╔══██║╚════██║╚════██║██╔══╝  ██║╚██╔╝██║ #
#  ██████╔╝   ██║       ██║     ██║  ██║███████╗██████╔╝██████╔╝██║███████╗    ██║  ██║██║ ╚████║██████╔╝    ██║  ██║███████║███████║███████╗██║ ╚═╝ ██║ #
#  ╚═════╝    ╚═╝       ╚═╝     ╚═╝  ╚═╝╚══════╝╚═════╝ ╚═════╝ ╚═╝╚══════╝    ╚═╝  ╚═╝╚═╝  ╚═══╝╚═════╝     ╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝╚═╝     ╚═╝ #
#						https://github.com/allamoox/BashSimpleChat.git		 	                                         #
##########################################################################################################################################################

printf "\033c"
cat banner

if [ -z $2 ]; then

	echo "Be sure to write $0 Chatter1 Nickname Chatter2 Nickname"
	exit 1
fi

if ! tmux -V > /dev/null 2>&1; then

	cat warnning
        exit 1
fi

PS3="Hello '$USER' Please chose one of the above options :- "
choice=("Press 1 for nc connection" "Press 2 for mkfifo connection" "Press 3 for xxxxx" "Press 4 to Exit")
select choice in "${choice[@]}"
do
    case "$choice" in
        "Press 1 for nc connection")
            tmux new \; split-window \; send-keys -t top C-L C-M "cat R" c-m "nc -l -p 1337" C-M \; send-keys -t bottom "nc localhost 1337" C-m ;
	    ;;
        "Press 2 for mkfifo connection")
	    echo "please open new terminal and issue $0 $2 $1"
	    FirstUser=/tmp/${1}
	    SecondUser=/tmp/${2}
	    mkfifo "$FirstUser"
	    mkfifo "$SecondUser"
	    cat "$SecondUser" &
	    echo "$1 joined" ; cat >> "$FirstUser"
         ;;
        "Press 3 for xxxxx")
	    echo "......Choice3....."
            ;;
        "Press 4 to Exit")
	    echo "GoodBye!"
	    break
	    ;;
        *) echo "$REPLY is not a valid choice, Please choose a number between 1 and 4"
	    ;;
    esac
done
